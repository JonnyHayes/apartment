<!-- Look for matching floor plans, based on selected number of bedrooms --> <script> function buildFloorNumberButtons() { for (var floorLevel = 9; floorLevel < 43; floorLevel++) { $('#floor_numbers_buttons').append($('<button>') .attr({ type: "button", class: "floor_numbers", value: floorLevel.toString(), }) .text(floorLevel.toString()) ); } } function disableFloorNumberButtons() { $('#floor_numbers_buttons button').each(function() { $(this).attr('disabled', true); }); } function disableWarningFloor() { $('#select-floor-warning').each(function() { $(this).fadeOut('slow'); }); } function disableWarningFloorPlan() { $('#select-floor-plan-warning').each(function() { $(this).fadeOut('slow'); }); } function disableWarningRooms() { $('#select-rooms-warning').each(function() { $(this).fadeOut('slow'); }); } function showWarningFloor() { $('#select-floor-warning').each(function() { $(this).fadeIn(1000); }); } function showWarningFloorPlan() { $('#select-floor-plan-warning').each(function() { $(this).fadeIn(1000); }); } function showWarningRooms() { $('#select-rooms-warning').each(function() { $(this).fadeIn(1000); }); } function hideFloorNumberButtons() { $('#floor_numbers_buttons button').each(function() { $(this).fadeOut('slow'); }); } function hideSummary() { $('.floor_plan_result').each(function() { $(this).fadeOut('slow'); }); } function showFloorNumberButtons() { $('#floor_numbers_buttons button').each(function() { $(this).fadeIn(1000); }); } function showSummary() { $('.floor_plan_result').each(function() { $(this).fadeIn(1000); }); } function clearActiveClassBedrooms() { $('#bedrooms button').each(function() { $(this).removeClass( 'active' ); }); } function clearActiveClassFloorPlan() { $('#floor_plan_group button').each(function() { $(this).removeClass( 'active' ); }); } function clearActiveClassFloor() { $('#floor_numbers_buttons button').each(function() { $(this).removeClass( 'active' ); }); } function clearSummary() { $('.floor_plan_summary').find('span').each(function() { $(this).text(''); }); $('.floor_plan_summary').find('img').each(function() { $(this).attr({ 'src': '', 'alt': '', }); }); } $(window).load(function() { buildFloorNumberButtons(); disableFloorNumberButtons(); hideFloorNumberButtons(); hideSummary(); }); $('.bedrooms').click(function(event) { $('#floor_plan_group button').each(function() { $(this).remove(); }); $('#choose-floor-plan-title').each(function() { $(this).remove(); }); disableFloorNumberButtons(); clearSummary(); clearActiveClassBedrooms(); clearActiveClassFloor(); hideSummary(); disableWarningFloor(); disableWarningFloorPlan(); disableWarningRooms(); showWarningFloorPlan(); $(this).addClass('active'); $('#floor_plan_group').before( '<h3 class=\"floor_plans\" id=\"choose-floor-plan-title\">Choose a floor plan</h3>'); {% for floor in floors %} if ( $(this).val() == '{{ floor.bd_ba }}' ) { $('#floor_plan_group').append($('<button>') .attr({ type: "button", class: "floor_plan_button", value: "{{ floor.floor_plan_id }}" }) .text("{{ floor.floor_plan_id}} | FACING: {{ floor.direction }} | {{ floor.square_footage}} SQ FT") ); } {% endfor %} }); $('#floor_plan_group').on('click', '.floor_plan_button', function() { disableFloorNumberButtons(); clearSummary(); $('#choose-floor-title').each(function() { $(this).remove(); }); showFloorNumberButtons(); clearActiveClassFloorPlan(); clearActiveClassFloor(); hideSummary(); $(this).addClass('active'); var clickedFloorPlan = $(this).val(); $('#floor_numbers_buttons').before( '<h3 class=\"floor_plans\" id=\"choose-floor-title\">Choose a floor</h3>'); {% for floor in floors %} if ( $(this).val() == '{{ floor.floor_plan_id }}' ) { {% for unit in units %} if ( ('{{ unit.floor_plan_relational}}' == '{{floor.id}}') && ('{{ unit.hide }}' == '0') ) { $('#floor_numbers_buttons button').each(function() { if ( $(this).val() == '{{ unit.level }}') { $(this).attr('disabled', false); } }); } {% endfor %} } {% endfor %} $('#floor_numbers_buttons').on('click', '.floor_numbers', function() { var clickedFloorInt = Number($(this).val()); var elevationResult = getElevations(clickedFloorInt); var resultViewDirection, resultViewElevation; clearActiveClassFloor(); showSummary(); $(this).addClass('active'); {% for unit in units %} if ( $(this).val() == '{{ unit.level }}' ) { {% for floor in floors %} if ( ('{{ floor.floor_plan_id }}' == clickedFloorPlan) && ('{{ unit.floor_plan_relational }}' == '{{ floor.id }}') ) { $('#floor-plan-summary-image').attr('src', '{{ Image(floor.floor_plan_image).src }}'); $('#floor-map-summary-image').attr('src', '{{ Image(floor.floor_plan_map).src }}'); $('#floor-id-summary').text('{{ floor.floor_plan_id }}'); $('#bedrooms-summary').text('{{ floor.bd_ba | slice(0,1) }} BR / {{ floor.bd_ba | slice(2)}} BA'); $('#square-footage-summary').text('{{ floor.square_footage }}'); $('#unit-id-summary').text('{{ unit.unit_id }}'); $('#price-summary').text('{{ unit.price }}'); $('#floor-title').text('FLOOR: '); $('#facing-title').text('FACING: '); $('#floor-plan-title').text('FLOOR PLAN: '); $('#price-title').text('PRICE: '); $('#regulated-term-title').text('Regulated Term: '); $('#unit-id-summary-modal').text('{{ unit.unit_id }}'); $('#pagetoshare').val('{{ site.url }}/units/{{ unit.unit_id }}'); $('#view-direction-summary').text('{{ floor.direction }}'); $('#view-elevation-summary').text('{{ unit.level }}'); if ( '{{ unit.regulated_term }}' == 'n/a' ) { $('.regulated-term').css({ 'display': 'none' }); } else { $('#regulated-term-summary').text('{{ unit.regulated_term }}'); } if({{ unit.sold }} == true){ $('#unit-sold').show(); }else{ $('#unit-sold').hide(); } } {% endfor %} {% for view_plane in view_planes %} if ( ('{{ view_plane.view_direction }}' == $('#view-direction-summary').text()) && ('{{ view_plane.view_elevation }}') == elevationResult ) { resultViewDirection = '{{ view_plane.view_direction }}'; resultViewElevation = '{{ view_plane.view_elevation }}'; if ( clickedFloorPlan == '1B-C2' ) { $('#view-plane-summary-image').attr('src', '../wp-content/uploads/2016/02/HHKK_30745_THUMBNAIL_ewa-b_' + elevationResult + '.jpg'); } else { $('#view-plane-summary-image').attr('src', '{{ Image(view_plane.thumbnail_pano).src }}'); } } {% endfor %} } {% endfor %} $('#view-plane-summary-link').click(function() { localStorage.setItem('viewDirectionSlideshow', resultViewDirection); localStorage.setItem('viewElevationSlideshow', resultViewElevation); }); }); }); </script> 